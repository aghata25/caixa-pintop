(()=>{"use strict";const n=function(n){return n.includes(",")&&(n=","===n[n.length-3]?n.replace(".","").replace(",","."):n.replace(",","")),n};var e=function(n,e,t,o){return new(t||(t=Promise))((function(i,c){function r(n){try{u(o.next(n))}catch(n){c(n)}}function a(n){try{u(o.throw(n))}catch(n){c(n)}}function u(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(r,a)}u((o=o.apply(n,e||[])).next())}))};var t,o;(o=t||(t={})).FACEBOOK="facebook",o.TIKTOK="tiktok",o.GOOGLE="google",o.SNAPCHAT="snapchat";const i=(e,t)=>{return o=void 0,i=void 0,r=function*(){const o=`${window.Shopify.checkout.order_id}`,i=window.Shopify.checkout.line_items.map((e=>{return{content_id:`${e.product_id}`,content_name:e.title,content_type:"product",content_description:"",content_image:(t=(null==e?void 0:e.image_url)||"",t.startsWith("//cdn.shopify.com")?"https:"+t:""),price:n(e.price),quantity:e.quantity};var t})),c=[],r=[],a=[],u=[];i.forEach((e=>{c.push(e.content_id),r.push(e.content_name),a.push(e.content_type),u.push({id:e.content_id,quantity:e.quantity,item_price:n(e.price)})}));const d=window.Shopify.checkout.line_items.reduce(((n,e)=>n+e.quantity),0);if(window.fbq("track","Purchase",{value:window.Shopify.checkout.total_price,currency:window.Shopify.checkout.currency,content_ids:c,content_name:r,content_type:a,contents:u,num_items:d},{eventID:o}),t)try{yield function(n,e,t){return fetch("https://events.adtrace.ai/event",{method:"POST",headers:{"Content-Type":"application/json","Shopify-Domain":e,"User-Agent":navigator.userAgent},body:JSON.stringify({event_id:n,event_name:"CompletePayment",contents:Array.isArray(t)?t:[t],currency:window.Shopify.checkout.currency,totalPrice:window.Shopify.checkout.total_price,event_context:{page:{url:window.location.href,referrer:document.referrer}},cookie:document.cookie})})}(o,e,i)}catch(n){console.log(n)}},new((c=void 0)||(c=Promise))((function(n,e){function t(n){try{u(r.next(n))}catch(n){e(n)}}function a(n){try{u(r.throw(n))}catch(n){e(n)}}function u(e){var o;e.done?n(e.value):(o=e.value,o instanceof c?o:new c((function(n){n(o)}))).then(t,a)}u((r=r.apply(o,i||[])).next())}));var o,i,c,r};!function(){var n,o,c,r;n=this,o=void 0,r=function*(){window.adtApps=window.adtApps||[],window.adtApps.push("facebook");const n=window.location.href,o=(n=>{const e=-1!==n.indexOf("thank_you"),t=-1!==n.indexOf("orders");return e||t})(n);if(!o)return;const c=window.Shopify.shop;if(!c)return;const r=yield((n,t)=>e(void 0,void 0,void 0,(function*(){const o=yield((n,t)=>e(void 0,void 0,void 0,(function*(){return(yield fetch(`https://events.adtrace.ai/checkout?shop=${n}&platform=${t}`)).json()})))(n,t),{serverSideApiEnabled:i,pixelCodes:c}=o;return{serverSideApiEnabled:i,pixelCodes:c}})))(c,t.FACEBOOK);var a,u,d,s,f;if(yield(a=r.pixelCodes,u=void 0,d=void 0,s=void 0,f=function*(){const n=document.createElement("script");n.innerHTML="\n        !function(f,b,e,v,n,t,s)\n        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?\n        n.callMethod.apply(n,arguments):n.queue.push(arguments)};\n        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';\n        n.queue=[];t=b.createElement(e);t.async=!0;\n        t.src=v;s=b.getElementsByTagName(e)[0];\n        s.parentNode.insertBefore(t,s)}(window, document,'script',\n        'https://connect.facebook.net/en_US/fbevents.js');",document.head.appendChild(n),a.forEach((n=>{window.fbq("init",n);const e=document.createElement("noscript");e.innerHTML=`\n            <img height="1" width="1" style="display:none"\n            src="https://www.facebook.com/tr?id=${n}&ev=PageView&noscript=1"/>\n        `,document.head.appendChild(e)})),window.fbq("track","PageView")},new(s||(s=Promise))((function(n,e){function t(n){try{i(f.next(n))}catch(n){e(n)}}function o(n){try{i(f.throw(n))}catch(n){e(n)}}function i(e){var i;e.done?n(e.value):(i=e.value,i instanceof s?i:new s((function(n){n(i)}))).then(t,o)}i((f=f.apply(u,d||[])).next())}))),-1!==n.indexOf("thank_you")){const n=!1;yield i(c,n)}},new((c=void 0)||(c=Promise))((function(e,t){function i(n){try{u(r.next(n))}catch(n){t(n)}}function a(n){try{u(r.throw(n))}catch(n){t(n)}}function u(n){var t;n.done?e(n.value):(t=n.value,t instanceof c?t:new c((function(n){n(t)}))).then(i,a)}u((r=r.apply(n,o||[])).next())}))}()})();